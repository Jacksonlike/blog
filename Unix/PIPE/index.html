<!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.lug.ustc.edu.cn/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="IPC,Unix,è¿›ç¨‹é€šä¿¡,C è¯­è¨€,"><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0"><meta name="description" content="è®¨è®º Unix ä¸‹çš„ IPC ï¼ˆè¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼‰--- ç®¡é“ PIPE"><meta name="keywords" content="IPC,Unix,è¿›ç¨‹é€šä¿¡,C è¯­è¨€"><meta property="og:type" content="article"><meta property="og:title" content="æµ…è°ˆ IPC çš„å‡ ç§æ–¹å¼ï¼ˆä¸€ï¼‰"><meta property="og:url" content="https://jacksonlike.cn/Unix/PIPE/index.html"><meta property="og:site_name" content="Coding Runner"><meta property="og:description" content="è®¨è®º Unix ä¸‹çš„ IPC ï¼ˆè¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼‰--- ç®¡é“ PIPE"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://jacksonlike.cn/images/background/barley.jpg"><meta property="og:image" content="https://jacksonlike.cn/images/ipc/1.png"><meta property="og:image" content="https://jacksonlike.cn/images/ipc/2.png"><meta property="og:image" content="https://jacksonlike.cn/images/ipc/3.png"><meta property="og:image" content="https://jacksonlike.cn/images/ipc/5.png"><meta property="og:image" content="https://jacksonlike.cn/images/ipc/4.png"><meta property="og:updated_time" content="2020-06-01T09:39:40.255Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="æµ…è°ˆ IPC çš„å‡ ç§æ–¹å¼ï¼ˆä¸€ï¼‰"><meta name="twitter:description" content="è®¨è®º Unix ä¸‹çš„ IPC ï¼ˆè¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼‰--- ç®¡é“ PIPE"><meta name="twitter:image" content="https://jacksonlike.cn/images/background/barley.jpg"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"right",display:"post"},fancybox:!0,motion:!0,duoshuo:{userId:"undefined",author:"åšä¸»"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://jacksonlike.cn/Unix/PIPE/"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1e92fb;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1e92fb,0 0 5px #1e92fb}.pace .pace-activity{border-top-color:#1e92fb;border-left-color:#1e92fb}</style><title> æµ…è°ˆ IPC çš„å‡ ç§æ–¹å¼ï¼ˆä¸€ï¼‰ | Coding Runner</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b6e35907910d61915fbb881eec0582d4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta custom-logo"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Coding Runner</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> é¦–é¡µ</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> å½’æ¡£</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> æ ‡ç­¾</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> æœç´¢</a></li></ul><div class="site-search"><div class="popup"><span class="search-icon fa fa-search"></span> <input type="text" id="local-search-input"><div id="local-search-result"></div> <span class="popup-btn-close">close</span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://jacksonlike.cn/Unix/PIPE/"><span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="ğŸ‘» æ°å…‹ç–¯ ğŸ‘»"><meta itemprop="description" content><meta itemprop="image" content="/images/avatar.jpg"></span><span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Coding Runner"> <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject"><img style="display:none" itemprop="url image" alt="Coding Runner" src="/images/avatar.jpg"></span></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> æµ…è°ˆ IPC çš„å‡ ç§æ–¹å¼ï¼ˆä¸€ï¼‰</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-21T15:24:20+00:00">2019-07-21</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Unix/" itemprop="url" rel="index"><span itemprop="name">Unix</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡</span> <span title="å­—æ•°ç»Ÿè®¡">1.7k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿</span> <span title="é˜…è¯»æ—¶é•¿">6</span></div><div class="post-description"> è®¨è®º Unix ä¸‹çš„ IPC ï¼ˆè¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼‰--- ç®¡é“ PIPE</div></div></header><div class="post-body" itemprop="articleBody"><p><img src="/images/background/barley.jpg" alt></p><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å­¦è€Œæ—¶ä¹ ä¹‹ä¸äº¦è¯´ä¹ï¼Œè¿›ç¨‹é—´é€šä¿¡ç›¸å…³çš„çŸ¥è¯†å…¶å®åœ¨å¾ˆä¹…ä»¥å‰å°±å­¦ä¹ è¿‡ï¼Œè¿™æ–¹é¢çš„çŸ¥è¯†å¤§éƒ¨åˆ†å·¥ä½œæ ¹æœ¬ç”¨ä¸ç€ï¼Œä½†æ˜¯å¯¹è‡ªå·±ç†è§£é«˜é˜¶ä»£ç æœ‰å¾ˆå¤§å¥½å¤„ï¼Œæ•…è€Œå€Ÿè¿™ä¸ªå‘¨æœ«åˆç¿»äº†ç¿» <a href="https://book.douban.com/subject/1788421" target="_blank" rel="noopener">APUE</a> ç›¸å…³ç« èŠ‚ï¼Œä»¥ä¸‹å¤ä¹ ç¬”è®°ï¼Œå’Œä¸€äº›è‡ªå·±çš„æ€»ç»“å’Œæ€è€ƒã€‚</p><h3 id="è¿›ç¨‹é—´é€šä¿¡"><a href="#è¿›ç¨‹é—´é€šä¿¡" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡"></a>è¿›ç¨‹é—´é€šä¿¡</h3><p>è¿›ç¨‹ä¹‹é—´äº¤æ¢ä¿¡æ¯å¸¸è§çš„é€”å¾„æœ‰å¦‚ä¸‹å‡ ç§:</p><ol><li>ç¬¬ä¸€ç§é€šè¿‡ fork ç”Ÿæˆå­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œåœ¨å­è¿›ç¨‹ä¸­éƒ½å¯ä»¥è·å–åˆ°ï¼Œè¾¾åˆ°å…±äº«ä¿¡æ¯çš„ç›®çš„ï¼Œä½†æ˜¯è¿™ç§ä¿¡æ¯äº¤æ¢çš„æ–¹å¼å¯¹äºæ²¡æœ‰äº²å±å…³ç³»çš„è¿›ç¨‹ä¹‹é—´æ˜¯æ— æ•ˆçš„ã€‚</li><li>ç¬¬äºŒç§æ˜¯é€šè¿‡çº¦å®šï¼Œå¤šä¸ªè¿›ç¨‹è¯»å†™åŒä¸€ä¸ªæ–‡ä»¶çš„æ–¹å¼è¿›è¡Œä¿¡æ¯äº¤æ¢ï¼Œè¿™ä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«æƒ³åˆ°çš„æ–¹å¼ã€‚å½“ç¨‹åºåŠå…¶ç®€å•çš„æ—¶å€™ï¼Œè¿™ç§æ–¹å¼å®ç°èµ·æ¥éå¸¸ç®€å•å€’æ˜¯è¿˜æœ‰ç”¨æ­¦ä¹‹åœ°ã€‚ä½†æ˜¯ä»£ç é‡å¤§èµ·æ¥ï¼Œæˆ–è€…é€»è¾‘å¤æ‚ä¹‹åï¼Œå°±æ˜¾å¾—æ¯”è¾ƒä½æ•ˆï¼Œè€Œä¸”å½“ä¸åŒè¿›ç¨‹åŒæ—¶è¯»å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œå®¹æ˜“å‘ç”Ÿæ··ä¹±ã€‚</li><li>ç¬¬ä¸‰ç§å°±æ˜¯ä»Šå¤©è¦ä»‹ç»çš„è¿›ç¨‹é—´é€šä¿¡ (InterProcess Communication, IPC)ã€‚å¸¸è§çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼åŒ…æ‹¬å¦‚ä¸‹å‡ ç§ï¼Œæ¥ä¸‹æ¥é€ä¸€ä»‹ç»ã€‚<ul><li><a href="#pipe">æ— åç®¡é“ PIPE</a></li><li><a href="#fifo">æœ‰åç®¡é“ FIFO</a></li><li><a href="#signal">ä¿¡å· signal</a></li><li><a href="#msg">æ¶ˆæ¯é˜Ÿåˆ— MSG</a></li><li><a href="#shm">å…±äº«å†…å­˜ SHM</a></li><li><a href="#sem">ä¿¡å·é‡ SEM</a></li><li><a href="#socket">å¥—æ¥å­— Socket</a></li></ul></li></ol><span id="pipe"><h3 id="æ— åç®¡é“-PIPE"><a href="#æ— åç®¡é“-PIPE" class="headerlink" title="æ— åç®¡é“ PIPE"></a>æ— åç®¡é“ PIPE</h3><p>ç®¡é“ï¼Œå‘½åå°±å¾ˆå½¢è±¡ï¼Œå¯ä»¥æƒ³è±¡æˆä¸€æ ¹æ°´ç®¡è¿æ¥ä¸¤ä¸ªè¿›ç¨‹ï¼Œä¸€è¾¹è¿›æ°´ä¸€è¾¹å‡ºæ°´ã€‚</p><h4 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h4><ul><li>æ²¡æœ‰åå­—ï¼Œæ— æ³•ä½¿ç”¨ open() è¿›è¡Œæ‰“å¼€</li><li>å› ä¸ºç¬¬ä¸€ä¸ªç‰¹ç‚¹ï¼Œæ²¡æœ‰åå­—ï¼Œä¸èƒ½ openï¼Œæ‰€ä»¥åªèƒ½ç”¨äºæœ‰å…±åŒç¥–å…ˆè¿›ç¨‹çš„è¿›ç¨‹ä¹‹é—´é€šä¿¡</li><li><a href="https://zh.wikipedia.org/w/index.php?title=%E9%9B%99%E5%B7%A5&oldformat=true&variant=zh-hans#%E5%8D%8A%E9%9B%99%E5%B7%A5" target="_blank" rel="noopener">åŠåŒå·¥</a>çš„å·¥ä½œæ–¹å¼ï¼Œè¿™ä¸€ç‚¹ä¹Ÿç±»ä¼¼äºçœŸå®çš„ç®¡é“ï¼Œè¯»ç«¯å†™ç«¯åˆ†å¼€</li><li>å½“è¦å†™å…¥çš„æ•°æ®é‡å¤§äº <code>PIPE_BUF</code> ï¼ˆPIPE_BUF çš„å¤§å°ä¸º4096å­—èŠ‚ï¼‰æ—¶ï¼Œå°†ä¸èƒ½ä¿è¯å†™å…¥çš„åŸå­æ€§ï¼Œæ‰€ä»¥ä¸€èˆ¬åªä½¿ç”¨äºä¸€å¯¹ä¸€çš„ç®€å•é€šä¿¡</li></ul><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>ç®¡é“æ˜¯é€šè¿‡ <code>pipe</code> å‡½æ•°åˆ›å»ºçš„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pipe</span><span class="params">(<span class="keyword">int</span> fd[<span class="number">2</span>])</span></span>;  <span class="comment">// åˆ›å»ºæˆåŠŸè¿”å› 0ï¼Œå¦åˆ™ä¸º -1</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°è¿”å›æˆåŠŸåï¼Œfd[0] æˆä¸ºè¯»ç«¯ï¼Œfd[1] æˆä¸ºå†™ç«¯ã€‚fd[1] è¯»å– fd[0] çš„è¾“å…¥ã€‚å®é™…ä¸Š PIPE å¹¶æ²¡æœ‰é™åˆ¶ä¸€å®šåœ¨ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹é—´ä½¿ç”¨ï¼Œä½†æ˜¯å•ä¸ªè¿›ç¨‹é—´çš„ç®¡é“æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä¹Ÿå°±ä¸åšè®¨è®ºã€‚ä¸‹å›¾æˆªè‡ª <a href="https://book.douban.com/subject/1788421" target="_blank" rel="noopener">APUE</a> æè¿°äº†ç®¡é“çš„ä¸€èˆ¬å·¥ä½œæ¨¡å‹ã€‚</p><p><img src="/images/ipc/1.png" alt></p><p>é¦–å…ˆè¿›ç¨‹è°ƒç”¨ <code>pipe</code> å‡½æ•°ï¼Œæ¥ç€è°ƒç”¨ <code>fork</code> å‡½æ•°åˆ›å»ºå­è¿›ç¨‹ï¼Œæ‰€ä»¥äº§ç”Ÿçš„å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹ä¸€æ ·éƒ½èƒ½è·å– PIPE è¯»ç«¯å’Œå†™ç«¯ã€‚ç´§æ¥ç€å„è‡ªå…³é—­æ‰€ä¸éœ€è¦çš„æ–‡ä»¶ IDï¼Œä¸Šå›¾è¡¨ç¤ºçš„æ˜¯çˆ¶è¿›ç¨‹ä¼ è¾“ä¿¡æ¯åˆ°å­è¿›ç¨‹ï¼Œæ‰€ä»¥çˆ¶è¿›ç¨‹å…³é—­äº†è¯»ç«¯ï¼Œå­è¿›ç¨‹å…³é—­äº†å†™ç«¯ã€‚å› ä¸ºç®¡é“çš„åŠåŒå·¥çš„ç‰¹ç‚¹ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨ä¸€ä¸ªç®¡é“è¿›è¡ŒåŒå‘çš„ä¿¡æ¯äº’æ¢ï¼Œæ›´å¸¸è§çš„æ˜¯åˆ›å»ºä¸¤ä¸ªç®¡é“è¿›è¡Œä¿¡æ¯äº’æ¢ï¼ˆå¦‚ååŒè¿›ç¨‹ï¼‰ã€‚</p><p>ç®€å•çš„ demo</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> fd[<span class="number">2</span>];</span><br><span class="line">	<span class="keyword">if</span> (<span class="number">-1</span> == pipe(fd)) &#123;</span><br><span class="line">		perror(<span class="string">"pipe error"</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">pid_t</span> pid = fork();</span><br><span class="line">	<span class="keyword">if</span> (pid &gt; <span class="number">0</span>) &#123;             <span class="comment">/* çˆ¶è¿›ç¨‹ */</span></span><br><span class="line">		close(fd[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">char</span> *s = <span class="string">"hello, i am your father!"</span>;</span><br><span class="line">		<span class="comment">// sleep(10);</span></span><br><span class="line">		write(fd[<span class="number">1</span>], s, <span class="built_in">strlen</span>(s));</span><br><span class="line">		close(fd[<span class="number">1</span>]);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (pid == <span class="number">0</span>) &#123;       <span class="comment">/* å­è¿›ç¨‹ */</span></span><br><span class="line">		close(fd[<span class="number">1</span>]);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">char</span> buf[<span class="number">30</span>];</span><br><span class="line">		bzero(buf, <span class="number">30</span>);</span><br><span class="line">		read(fd[<span class="number">0</span>], buf, <span class="number">30</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"read from father:%s\n"</span>, buf);</span><br><span class="line">		</span><br><span class="line">		close(fd[<span class="number">0</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		perror(<span class="string">"fork error"</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">/**************************************************</span></span><br><span class="line"><span class="comment"> * ouputï¼šread from father:hello, i am your father!</span></span><br><span class="line"><span class="comment"> ****************************************************/</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼ŒPIPE æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€èˆ¬çš„æ–‡ä»¶ IO å‡½æ•°è¿›è¡Œè¯»å†™ï¼Œä½†æ˜¯åŒ FIFOã€socket ä¸€æ ·æ˜¯ä¸èƒ½ä½¿ç”¨ <code>lseek</code> ä¹‹ç±»çš„å‡½æ•°è¿›è¡Œå®šä½ï¼Œå› ä¸ºå®ƒä»¬ä¸åŒäºæ™®é€šæ–‡ä»¶å­˜åœ¨äºç¡¬ç›˜ã€Flash ç­‰å—è®¾å¤‡ä¸Šï¼Œå®ƒä»¬åªå­˜åœ¨äºå†…å­˜ï¼Œç”±å†…æ ¸ç»´æŠ¤ã€‚</p><p>å¦‚æœæƒ³æŸ¥çœ‹è¿›ç¨‹çš„ç®¡é“ï¼Œå¯ä»¥å°†ä¸Šè¿°ç¤ºä¾‹ä»£ç ï¼Œsleep å–æ¶ˆæ³¨é‡Šå†è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç»“æœã€‚</p><p><img src="/images/ipc/2.png" alt></p><h4 id="shell-ä¸­çš„ç®¡é“"><a href="#shell-ä¸­çš„ç®¡é“" class="headerlink" title="shell ä¸­çš„ç®¡é“"></a>shell ä¸­çš„ç®¡é“</h4><p>å®é™…ä¸Šæœ‰äº†ä»¥ä¸Šçš„åŸºç¡€ä¹‹åï¼Œshellä¸­çš„ç®¡é“å€’æ˜¯å¾ˆå®¹æ˜“ç†è§£ã€‚</p><p>ä¸‹å›¾è¯´æ˜äº†å¦‚ä½•é€šè¿‡ç®¡é“è¿æ¥ <code>find</code>ã€<code>grep</code> å’Œ <code>wc</code> å‘½ä»¤ï¼Œå°† <code>find</code> å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼ˆé€šè¿‡ <code>dup2</code> æ¥å£ ï¼‰åˆ°ç®¡é“çš„å†™ç«¯ï¼Œè€Œå°† <code>grep</code> å‘½ä»¤çš„æ ‡å‡†è¾“å…¥æŒ‡å‘ç®¡é“çš„è¯»ç«¯ã€‚<code>grep</code> å’Œ <code>wc</code> ä¹‹é—´ä¹Ÿæ˜¯åŒç†ã€‚</p><p><img src="/images/ipc/3.png" alt></p><span id="fifo"><h3 id="æœ‰åç®¡é“-FIFO"><a href="#æœ‰åç®¡é“-FIFO" class="headerlink" title="æœ‰åç®¡é“ FIFO"></a>æœ‰åç®¡é“ FIFO</h3><p> <code>PIPE</code> æœ€å¤§çš„åŠ£åŠ¿å°±æ˜¯åªèƒ½ä½¿ç”¨åœ¨æœ‰å…±åŒç¥–å…ˆçš„è¿›ç¨‹é—´ï¼Œåº”ç”¨åœºæ™¯å•ä¸€ï¼Œæ€§èƒ½è¾ƒå¼±ï¼Œé™åˆ¶æ¡ä»¶åˆå¤ªå¤šã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§æ›´å¼ºå¤§çš„ç®¡é“ <code>FIFO</code> ã€‚</p><h4 id="ç‰¹å¾-1"><a href="#ç‰¹å¾-1" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h4><ul><li>æœ‰åå­—ï¼Œå­˜åœ¨äºæ™®é€šçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ‰€ä»¥ä»»ä½•æœ‰æƒé™çš„è¿›ç¨‹éƒ½å¯ä»¥é€šè¿‡æ–‡ä»¶ IO å‡½æ•°è¯»å†™ <code>FIFO</code></li><li>å…·æœ‰å†™å…¥åŸå­æ€§ï¼Œå¤šå†™è€…åŒæ—¶è¿›è¡Œæ“ä½œä¸ä¼šå‡ºç°æ•°æ®æ··ä¹±</li><li>First In First Out åŸåˆ™ï¼Œæœ€å…ˆå†™å…¥å°±ä¼šæœ€å…ˆè¢«è¯»å‡º</li></ul><h4 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># read.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FIFO <span class="meta-string">"/tmp/fifotest"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (access(FIFO, F_OK)) &#123;</span><br><span class="line">		mkfifo(FIFO, <span class="number">0644</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> fifo = open(FIFO, O_RDONLY); <span class="comment">// åªè¯»çš„æ–¹å¼æ‰“å¼€FIFO</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">char</span> msg[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">memset</span>(msg, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">	read(fifo, msg, <span class="number">20</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"read from FIFO: %s\n"</span>, msg);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># write.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FIFO <span class="meta-string">"/tmp/fifotest"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (access(FIFO, F_OK)) &#123;</span><br><span class="line">		mkfifo(FIFO, <span class="number">0644</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> fifo = open(FIFO, O_WRONLY); <span class="comment">// åªå†™çš„æ–¹å¼æ‰“å¼€FIFO</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">char</span> msg[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">memset</span>(msg, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">	fgets(msg, <span class="number">20</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	<span class="keyword">int</span> n = write(fifo, msg, <span class="built_in">strlen</span>(msg));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sebded %d bytes to FIFO\n"</span>, n);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å®Œæ•´æºç <a href="https://github.com/Jacksonlike/blog_code/tree/master/IPC" target="_blank" rel="noopener">åœ°å€</a>ã€‚ä»£ç æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ã€‚<br><img src="/images/ipc/5.png" alt></p><p>ç¤ºä¾‹ä»£ç éå¸¸çš„ç®€å•ï¼Œä¸è¿‡æœ‰ä»¥ä¸‹å‡ ç‚¹è¿›è¡Œè¯´æ˜ï¼š</p><ul><li><p>read å’Œ write æ˜¯ä¸¤ä¸ªåŒæ—¶ç‹¬ç«‹è¿è¡Œçš„è¿›ç¨‹ã€‚</p></li><li><p>åˆšå¼€å§‹è¿è¡Œ read è¿›ç¨‹è€Œè¿˜æ²¡è¿è¡Œ write è¿›ç¨‹æ—¶ï¼Œæˆ–è€…æ˜¯è¿è¡Œäº† write è¿›ç¨‹ä¸” read è¿›ç¨‹è¿˜æ²¡æœ‰è¿è¡Œæ—¶ï¼Œ<code>open</code> å‡½æ•°ä¼šè¢«é˜»å¡ï¼Œå› ä¸ºç®¡é“æ–‡ä»¶ï¼ˆåŒ…æ‹¬ <code>FIFO</code>ã€<code>PIPE</code> å’Œ <code>socket</code> ï¼‰ä¸å¯ä»¥åªæœ‰è¯»ç«¯æˆ–è€…åªæœ‰å†™ç«¯è¢«æ‰“å¼€ã€‚</p></li><li><p>é™¤äº†æ‰“å¼€ç®¡é“çš„æ—¶å€™å¯èƒ½å‘ç”Ÿé˜»å¡ï¼Œåœ¨è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™ä¹Ÿå¯èƒ½ä¼šå‘ç”Ÿé˜»å¡ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src="/images/ipc/4.png" alt></p></li><li><p>å½“è°ƒç”¨ <code>open</code> ï¼ˆæˆ–è€…è°ƒç”¨ <code>fcntl</code> ï¼‰æ—¶ï¼ŒæŒ‡å®š <code>O_NONBLOCK</code> çš„æ ‡å¿—ï¼Œåˆ™ç®¡é“ä¸ä¼šé˜»å¡ã€‚å…·ä½“è§„åˆ™ä¸ä¸Šè¿°æœ‰æ‰€åŒºåˆ«ï¼Œå¦‚æœéœ€è¦å¯ä»¥æŸ¥çœ‹ <a href="[https://github.com/lancetw/ebook-1/blob/master/01_programming/UNIX%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%8D%B72%EF%BC%9A%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%EF%BC%88%E7%AC%AC2%E7%89%88%EF%BC%89.pdf](https://github.com/lancetw/ebook-1/blob/master/01_programming/UNIXç½‘ç»œç¼–ç¨‹å·2ï¼šè¿›ç¨‹é—´é€šä¿¡ï¼ˆç¬¬2ç‰ˆï¼‰.pdf)">UNIXç½‘ç»œç¼–ç¨‹å·2 ç¬¬å››ç« </a> ï¼Œä¹¦ä¸­æœ‰è¯¦ç»†æè¿°ã€‚</p></li></ul><h3 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3><p><a href="https://www.ibm.com/developerworks/cn/aix/library/au-spunix_pipeviewer/index.html" target="_blank" rel="noopener">å¯¹è¯ UNIX æ¢ç´¢ç®¡é“</a><br><a href="https://book.douban.com/subject/1788421" target="_blank" rel="noopener">Unix ç¯å¢ƒé«˜çº§ç¼–ç¨‹</a><br><a href="https:s//book.douban.com/subject/4118577/" target="_blank" rel="noopener">UNIXç½‘ç»œç¼–ç¨‹ å·2</a></p></span></span></div><div></div><div class="post-tags"> <a href="/tags/IPC/" rel="tag"># IPC</a> <a href="/tags/Unix/" rel="tag"># Unix</a> <a href="/tags/è¿›ç¨‹é€šä¿¡/" rel="tag"># è¿›ç¨‹é€šä¿¡</a> <a href="/tags/C-è¯­è¨€/" rel="tag"># C è¯­è¨€</a></div><div></div><footer class="post-footer"><div><ul class="post-copyright"><li class="post-copyright-link"> <strong>æœ¬æ–‡ä½œè€…ï¼š</strong> <a href="/" title="æ¬¢è¿è®¿é—® ğŸ‘» æ°å…‹ç–¯ ğŸ‘» çš„ä¸ªäººåšå®¢">ğŸ‘» æ°å…‹ç–¯ ğŸ‘»</a></li><li class="post-copyright-link"> <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://jacksonlike.cn/Unix/PIPE/" title="æµ…è°ˆ IPC çš„å‡ ç§æ–¹å¼ï¼ˆä¸€ï¼‰">https://jacksonlike.cn/Unix/PIPE/</a></li><li class="post-copyright-license"> <strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬æ–‡ç”± ğŸ‘» æ°å…‹ç–¯ ğŸ‘» åŸåˆ›ï¼Œé‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="license" target="_blank">CC BY-NC-SA 4.0ï¼Œ</a> è½¬è½½è¯·ä¿ç•™ä»¥ä¸Šå£°æ˜ä¿¡æ¯ï¼</li></ul></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/Life/helloworld/" rel="next" title="Hello World"><i class="fa fa-chevron-left"></i> Hello World</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/Python/metaclass/" rel="prev" title="Python å…ƒç±»(Metaclass)">Python å…ƒç±»(Metaclass)<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC80NDE5Ny8yMDczMA=="></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview" data-target="site-overview"> ç«™ç‚¹æ¦‚è§ˆ</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="ğŸ‘» æ°å…‹ç–¯ ğŸ‘»"><p class="site-author-name" itemprop="name">ğŸ‘» æ°å…‹ç–¯ ğŸ‘»</p><p class="site-description motion-element" itemprop="description">ä¸€ç›´åœ¨å­¦ç€å†™ä»£ç çš„ç¨‹åºå‘˜ ğŸ¥¤ğŸ¥¤ğŸ¥¤</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">6</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories"><span class="site-state-item-count">6</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">16</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Jacksonlike" target="_blank" title="GitHub"><i class="fa fa-fw fa-github-alt"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://note.jacksonlike.cn/" target="_blank" title="Note"><i class="fa fa-fw fa-leanpub"></i> Note</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹é—´é€šä¿¡"><span class="nav-number">2.</span> <span class="nav-text">è¿›ç¨‹é—´é€šä¿¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ— åç®¡é“-PIPE"><span class="nav-number">3.</span> <span class="nav-text">æ— åç®¡é“ PIPE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹å¾"><span class="nav-number">3.1.</span> <span class="nav-text">ç‰¹å¾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨"><span class="nav-number">3.2.</span> <span class="nav-text">ä½¿ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell-ä¸­çš„ç®¡é“"><span class="nav-number">3.3.</span> <span class="nav-text">shell ä¸­çš„ç®¡é“</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ‰åç®¡é“-FIFO"><span class="nav-number">4.</span> <span class="nav-text">æœ‰åç®¡é“ FIFO</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹å¾-1"><span class="nav-number">4.1.</span> <span class="nav-text">ç‰¹å¾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨-1"><span class="nav-number">4.2.</span> <span class="nav-text">ä½¿ç”¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‚è€ƒæ–‡æ¡£"><span class="nav-number">5.</span> <span class="nav-text">å‚è€ƒæ–‡æ¡£</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">ğŸ‘» æ°å…‹ç–¯ ğŸ‘»</span></div><div class="powered-by"> ç”± <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> å¼ºåŠ›é©±åŠ¨</div><div class="theme-info"> ä¸»é¢˜ - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Mist</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><script type="text/javascript">var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path;function proceedsearch(){$("body").append('<div class="popoverlay">').css("overflow","hidden"),$(".popup").toggle()}var searchFunc=function(e,c,n){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),a=document.getElementById(c),r=document.getElementById(n);a.addEventListener("input",function(){var u=0,d='<ul class="search-result-list">',f=this.value.trim().toLowerCase().split(/[\s\-]+/);r.innerHTML="",1<this.value.trim().length&&t.forEach(function(e){var a=!1,r=e.title.trim().toLowerCase(),c=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),t=decodeURIComponent(e.url),n=-1,s=-1,o=-1;if(""!=r&&f.forEach(function(e,t){n=r.indexOf(e),s=c.indexOf(e),(0<=n||0<=s)&&(a=!0,0==t&&(o=s))}),a){u+=1,d+="<li><a href='"+t+"' class='search-result-title'>"+r+"</a>";var i=e.content.trim().replace(/<[^>]+>/g,"");if(0<=o){var l=o-20,p=o+80;l<0&&(l=0),0==l&&(p=50),p>i.length&&(p=i.length);var h=i.substring(l,p);f.forEach(function(e){var t=new RegExp(e,"gi");h=h.replace(t,'<b class="search-keyword">'+e+"</b>")}),d+='<p class="search-result">'+h+"...</p>"}d+="</li>"}}),d+="</ul>",0==u&&(d='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==f&&(d='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),r.innerHTML=d}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".popoverlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="/js/src/love.js"></script></body></html>